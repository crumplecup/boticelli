# Boticelli TUI User Guide

Terminal User Interface for reviewing, editing, and managing AI-generated content.

## Table of Contents

- [Overview](#overview)
- [Installation](#installation)
- [Quick Start](#quick-start)
- [Interface Overview](#interface-overview)
- [Views and Modes](#views-and-modes)
- [Keyboard Shortcuts](#keyboard-shortcuts)
- [Workflows](#workflows)
- [Troubleshooting](#troubleshooting)

## Overview

The Boticelli TUI is an interactive terminal interface for managing content generated by AI narratives. It provides a fast, keyboard-driven workflow for:

- **Browsing** generated content in a table view
- **Reviewing** individual items with full JSON details
- **Editing** tags, ratings, and review status
- **Comparing** multiple content variants side-by-side
- **Promoting** approved content to production tables
- **Deleting** unwanted content

### When to Use the TUI

The TUI is ideal for:

- **Content Review Sessions**: Quickly review 10-100 generated items
- **Quality Control**: Tag, rate, and approve content before publication
- **A/B Testing**: Compare multiple variants and select the best
- **Bulk Management**: Efficiently process large batches of generated content

### Prerequisites

- Boticelli compiled with `--features tui` or `--all-features`
- PostgreSQL database with generated content tables
- Terminal with ANSI color support (most modern terminals)

## Installation

### Build with TUI Support

```bash
# Build with all features (recommended)
cargo build --all-features

# Or build with just TUI feature
cargo build --features tui,database
```

### Verify Installation

```bash
# Check that tui command is available
./target/debug/boticelli tui --help
```

## Quick Start

### 1. Generate Some Content

First, generate content using a narrative with a template:

```bash
# Create a narrative that generates content
boticelli run --narrative narratives/generate_guilds.toml

# This creates a table like 'guilds_generation_001'
```

### 2. Launch the TUI

```bash
# Launch TUI for the generated content table
boticelli tui guilds_generation_001
```

### 3. Basic Navigation

```
↑↓ or j/k    Navigate list
Enter        View details
e            Edit item
q or Esc     Quit/back
```

## Interface Overview

The TUI has three main sections:

```
┌─────────────────────────────────────────────────────────┐
│ Boticelli Content Review - guilds_generation_001       │ ← Header
├─────────────────────────────────────────────────────────┤
│                                                         │
│                                                         │
│                  [Main Content Area]                    │ ← Main View
│                                                         │
│                                                         │
├─────────────────────────────────────────────────────────┤
│ Status: Ready | ↑↓: Navigate | Enter: Detail | Q: Quit │ ← Status Bar
└─────────────────────────────────────────────────────────┘
```

### Header

- Shows current table name
- Always visible at top

### Main Content Area

- Changes based on current mode (List, Detail, Edit, Compare, Export)
- Most of the screen real estate

### Status Bar

- Shows current status message on left
- Shows available keyboard shortcuts on right
- Context-sensitive to current mode

## Views and Modes

### List View (Default)

The main browsing interface showing all content in a table.

```
┌───────┬─────────┬────────┬────────┬──────────────────────┐
│ ID    │ Status  │ Rating │ Tags   │ Preview              │
├───────┼─────────┼────────┼────────┼──────────────────────┤
│ > 101 │ pending │ ★★★☆☆  │ viral  │ {"id": 101, "name... │
│   102 │ approved│ ★★★★★  │ humor  │ {"id": 102, "name... │
│   103 │ pending │ ---    │        │ {"id": 103, "name... │
└───────┴─────────┴────────┴────────┴──────────────────────┘
```

**Columns:**
- **ID**: Database primary key
- **Status**: Review status (pending, approved, rejected)
- **Rating**: User rating (★ = 1-5, --- = unrated)
- **Tags**: Comma-separated tags
- **Preview**: First 50 characters of JSON content

**Visual Indicators:**
- `>` symbol marks selected row (highlighted in cyan)
- Green text indicates items selected for comparison
- White text for normal items

### Detail View

Full view of a single content item with all metadata and JSON content.

```
ID: 101
Status: pending
Rating: ★★★
Tags: viral, gaming, community
Narrative: guilds_generation.toml
Act: gaming_community

Content:
{
  "id": 101,
  "name": "Epic Gaming Guild",
  "owner_id": 200,
  "description": "A community for serious gamers...",
  ...
}
```

Press `e` to edit, `Esc` to return to list.

### Edit Mode

Inline editing for metadata fields.

```
┌─────────────────────────────────────────┐
│ Tags (comma-separated)                  │
│ viral, gaming, community                │
└─────────────────────────────────────────┘

┌─────────────────────────────────────────┐
│ Rating (1-5)                            │
│ 3                                       │
└─────────────────────────────────────────┘

┌─────────────────────────────────────────┐
│ Status (pending/approved/rejected)      │
│ pending                                 │
└─────────────────────────────────────────┘
```

**Current Limitations:**
- Text editing not yet implemented (placeholder UI)
- Use CLI commands for editing until text input is added

**Planned Features:**
- Full text input with cursor navigation
- Tab to switch between fields
- Validation for rating and status values

### Compare View

Side-by-side comparison of 2+ content variants.

```
┌─────────────────────┬─────────────────────┐
│ Item 101            │ Item 102            │
│ Status: pending     │ Status: approved    │
│ Rating: ★★★         │ Rating: ★★★★★       │
│ Tags: viral, gaming │ Tags: humor         │
│                     │                     │
│ {                   │ {                   │
│   "id": 101,        │   "id": 102,        │
│   "name": "Epic..." │   "name": "Funny..."│
│   ...               │   ...               │
│ }                   │ }                   │
└─────────────────────┴─────────────────────┘
```

**To compare items:**
1. In List View, press `c` on first item (turns green)
2. Press `c` on second item (turns green, opens compare view)
3. Press `Esc` to return to list

### Export View

Placeholder for export functionality.

```
┌─────────────────────────────────────────┐
│                                         │
│   Export functionality coming soon...   │
│                                         │
└─────────────────────────────────────────┘
```

**Planned Features:**
- Export to JSON file
- Export to CSV file
- Filter by status, tags, rating before export
- Custom field selection

## Keyboard Shortcuts

### Global (All Modes)

| Key | Action |
|-----|--------|
| `q` | Quit application (or return to previous view) |
| `Esc` | Same as `q` |
| `?` | Show help (future feature) |

### List View

| Key | Action |
|-----|--------|
| `↑` or `k` | Move selection up |
| `↓` or `j` | Move selection down |
| `Enter` | View details of selected item |
| `e` | Edit selected item |
| `c` | Toggle item for comparison (select 2+, then auto-opens compare) |
| `D` (Shift+d) | Delete selected item |
| `r` | Reload content from database |
| `q` | Quit TUI |

### Detail View Shortcuts

| Key | Action |
|-----|--------|
| `Esc` | Return to list view |
| `e` | Enter edit mode for this item |
| `q` | Return to list view |

### Edit Mode Shortcuts

| Key | Action |
|-----|--------|
| `Ctrl+Enter` | Save changes and return to list |
| `Esc` | Cancel editing and return to list |
| `Tab` | Switch between fields (future) |

### Compare View Shortcuts

| Key | Action |
|-----|--------|
| `Esc` | Return to list view |
| `q` | Return to list view |

## Workflows

### Workflow 1: Quick Review and Approval

Review and approve generated content in bulk.

```bash
# 1. Generate content
boticelli run --narrative weekly_posts.toml

# 2. Launch TUI
boticelli tui weekly_posts_001

# 3. In TUI:
#    - Use ↓ to browse items
#    - Press Enter to view details
#    - Press e to edit (mark as approved)
#    - Repeat for all items

# 4. From CLI, promote approved items
boticelli content promote weekly_posts_001 123 --target discord_messages
```

### Workflow 2: A/B Test Content Variants

Generate multiple variants and select the best.

```bash
# 1. Generate 5 variants
boticelli run --narrative announcement_variants.toml

# 2. Launch TUI
boticelli tui announcement_variants

# 3. In TUI:
#    - Select first variant with c
#    - Navigate to second variant with ↓
#    - Press c again (opens compare view)
#    - Press Esc, select another pair to compare
#    - Mentally note the best variant

# 4. Tag the winner
boticelli content tag announcement_variants 3 --tags "winner,final"

# 5. Promote the winner
boticelli content promote announcement_variants 3 --target discord_messages
```

### Workflow 3: Bulk Cleanup

Delete unwanted content after review.

```bash
# 1. Launch TUI
boticelli tui test_generation_042

# 2. In TUI:
#    - Navigate to unwanted item with ↓
#    - Press D (Shift+d) to delete
#    - Repeat for all unwanted items

# 3. Approved items remain for promotion
```

### Workflow 4: Quality Control Pipeline

Tag and rate content for quality tracking.

```bash
# 1. Launch TUI
boticelli tui channel_ideas

# 2. For each item:
#    - Press Enter to view details
#    - Read content carefully
#    - Press e to edit
#    - (Use CLI for now: boticelli content tag channel_ideas 123 --tags "excellent" --rating 5)
#    - Press Esc to return
#    - Navigate to next with ↓

# 3. Export high-rated items
boticelli content list channel_ideas --status approved --limit 1000 > approved.json
```

## Troubleshooting

### TUI Won't Launch

**Error**: `error: Found argument 'tui' which wasn't expected`

**Solution**: Rebuild with TUI feature enabled:
```bash
cargo build --all-features
```

### Table Not Found

**Error**: `Error: Table 'my_table' does not exist`

**Solution**: Check available tables:
```bash
psql -d boticelli -c "\dt"
```

Ensure you're using the exact table name from the database.

### Terminal Display Issues

**Issue**: Colors or layout look wrong

**Solutions**:
- Ensure terminal supports ANSI colors
- Try a different terminal (e.g., `alacritty`, `kitty`, `wezterm`)
- Increase terminal window size (minimum 80x24 recommended)
- Check `TERM` environment variable: `echo $TERM` should be `xterm-256color` or similar

### Database Connection Failed

**Error**: `Failed to establish database connection`

**Solution**: Check environment variables:
```bash
# Check DATABASE_URL is set
echo $DATABASE_URL

# Or check individual variables
echo $DATABASE_USER
echo $DATABASE_PASSWORD
echo $DATABASE_HOST
echo $DATABASE_PORT
echo $DATABASE_NAME
```

Set in `.env` file:
```bash
DATABASE_URL=postgres://user:pass@localhost:5432/boticelli
```

### Empty Content List

**Issue**: TUI shows "No content found"

**Solutions**:
1. Verify table has data: `boticelli content list your_table_name`
2. Check table was created by content generation processor (has metadata columns)
3. Generate content if table is empty:
   ```bash
   boticelli run --narrative your_narrative.toml
   ```

### Can't Edit Text Fields

**Current Limitation**: Text editing UI is not yet implemented.

**Workaround**: Use CLI commands:
```bash
# Edit tags and rating
boticelli content tag your_table 123 --tags "tag1,tag2" --rating 4

# Edit review status
boticelli content review your_table 123 approved
```

### Performance Issues with Large Tables

**Issue**: TUI slow with 1000+ items

**Workarounds**:
- Current version loads max 1000 items (hard-coded in `reload_content()`)
- For larger datasets, use CLI filtering:
  ```bash
  # Work with pending items only
  boticelli content list your_table --status pending
  ```
- Future: Pagination and lazy loading

## Advanced Usage

### Custom Database Connection

Override default connection settings:

```bash
# Use different database
DATABASE_NAME=boticelli_test boticelli tui my_table

# Use remote database
DATABASE_HOST=db.example.com DATABASE_PORT=5433 boticelli tui my_table
```

### Multiple TUI Sessions

You can run multiple TUI instances on different tables:

```bash
# Terminal 1
boticelli tui guilds_gen_001

# Terminal 2
boticelli tui channels_gen_002
```

Each has independent state and database connection.

### Integration with External Tools

Export and process with other tools:

```bash
# Export approved content
boticelli content list my_table --status approved > approved.json

# Process with jq
cat approved.json | jq '.[] | select(.rating >= 4)'

# Import into spreadsheet
boticelli content list my_table --status approved | csv2xlsx > report.xlsx
```

## Tips and Best Practices

### Efficient Navigation

- **Use vim keys**: `j`/`k` is faster than arrow keys for power users
- **Mark for later**: Use `c` to mark items, even if not comparing
- **Review in batches**: Review 10-20 items, take a break, continue

### Content Review Strategy

1. **First Pass**: Quick scan, delete obvious rejects with `D`
2. **Second Pass**: View details (`Enter`), rate items
3. **Third Pass**: Compare top candidates with `c`
4. **Final Pass**: Tag winners, promote to production

### Tagging Conventions

Develop consistent tag vocabulary:

- **Quality**: `excellent`, `good`, `poor`
- **Category**: `viral`, `educational`, `humor`, `serious`
- **Status**: `ready`, `needs-work`, `blocked`
- **Priority**: `urgent`, `normal`, `low`

Example:
```bash
boticelli content tag my_table 123 --tags "excellent,viral,ready,urgent" --rating 5
```

### Backup Before Bulk Operations

Before bulk deletes:

```bash
# Export table to JSON
boticelli content list my_table --limit 10000 > backup_$(date +%Y%m%d).json

# Now safe to delete in TUI
boticelli tui my_table
```

## Future Features

Planned enhancements for future releases:

- [ ] **Text editing**: Full keyboard input in Edit Mode
- [ ] **Pagination**: Handle 10,000+ item tables efficiently
- [ ] **Search/Filter**: Filter by tags, status, rating in List View
- [ ] **Bulk operations**: Select multiple items, apply action to all
- [ ] **Export**: JSON/CSV export directly from TUI
- [ ] **Promotion dialog**: Select target table from TUI
- [ ] **Undo**: Undo delete and edit operations
- [ ] **Themes**: Customizable color schemes
- [ ] **Help screen**: Press `?` for keyboard shortcuts reference
- [ ] **Sort**: Sort list by ID, status, rating, tags
- [ ] **Stats**: Show summary statistics (counts by status, avg rating)

## Getting Help

- **Documentation**: This guide and `README.md`
- **CLI Help**: `boticelli tui --help`
- **Issues**: https://github.com/crumplecup/boticelli/issues
- **Discussions**: https://github.com/crumplecup/boticelli/discussions

## License

Boticelli is dual-licensed under MIT OR Apache-2.0.
